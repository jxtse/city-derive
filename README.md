
# 🌟 智能散步路线规划器

一个基于AI的智能散步路线规划系统，集成高德地图API和Dify AI，提供两种探索模式：导航模式和探索模式。

## 📋 项目组件

### 🧠 导航模式 (index.html)
AI驱动的智能路线规划，让LLM完全主导规划决策过程。

### 🧭 探索模式 (navigation.html)
基于当前位置的AI智能问答和导航建议系统。

## ✨ 核心功能

### 🧠 导航模式功能
- **🤖 LLM智能规划**：由Claude-4 AI完全主导路线决策
- **📍 智能地点搜索**：AI自主调用高德地图API搜索符合偏好的地点
- **🛣️ 真实路径规划**：获取实际步行道路路径，不是直线连接
- **⚡ 函数名自动修正**：AI输出错误函数名时自动纠正，提升系统鲁棒性
- **🎯 个性化偏好**：支持水景、公园、历史、商业、自然、科技等不同偏好
- **📊 详细路线分析**：包含距离、时间、难度评分等详细信息
- **🔄 AI终端实时显示**：酷炫的终端界面显示AI决策过程

### 🧭 探索模式功能
- **📍 自动定位**：获取用户当前位置并分析周边环境
- **🤖 Dify AI集成**：基于位置信息提供智能问答和建议
- **💬 交互式对话**：AI提出问题，用户选择后获得个性化指令
- **🗺️ 实时地图显示**：高德地图显示当前位置和周边信息
- **📱 移动端优化**：响应式设计，支持移动设备

### 🛠️ 技术特色
- **🔧 自动API密钥管理**：支持环境变量和本地存储
- **🛡️ 错误处理机制**：完善的API调用重试和错误恢复
- **📊 详细统计信息**：显示AI规划过程、函数修正次数等
- **💾 数据导出功能**：支持JSON、GPX、文本等多种格式导出
- **🎨 现代化UI设计**：渐变背景、卡片设计、动画效果

## 🚀 快速开始

### 1. 配置API密钥
在 `config.js` 文件中设置你的API密钥：

```javascript
window.API_CONFIG = {
    AMAP_API_KEY: 'your-amap-api-key',
    DIFY_API_TOKEN: 'your-dify-api-token',
    OPENROUTER_API_KEY: 'your-openrouter-api-key'
};
```

### 2. 启动项目
项目已配置为在Replit上运行，点击Run按钮即可启动：

```bash
python -m http.server 5000
```

访问 `http://0.0.0.0:5000` 查看导航模式  
访问 `http://0.0.0.0:5000/navigation.html` 查看探索模式

## 🎯 使用指南

### 导航模式使用流程
1. **选择起点**：输入出发地址（如"五道口地铁站"）
2. **设置偏好**：选择城市、距离、偏好类型、终点类型
3. **启动AI规划**：点击"启动AI智能规划"按钮
4. **观看AI过程**：终端显示AI的决策过程和API调用
5. **查看结果**：获得详细的路线规划和实用建议

### 探索模式使用流程
1. **自动定位**：系统获取当前位置
2. **AI分析**：Dify AI分析位置并提出问题
3. **交互选择**：根据AI问题选择偏好选项
4. **获得指令**：收到个性化的导航建议
5. **完成任务**：按指令行动后点击"已完成"继续

## 🧠 AI技术架构

### LLM智能规划流程
```
用户输入 → LLM分析需求 → 自主调用地图API → 
智能筛选地点 → 规划最优路径 → 生成详细方案
```

### 关键技术组件
- **LLMPlanningAgent**：核心AI规划代理
- **函数名映射系统**：自动修正AI输出的错误函数名
- **智能参数解析**：从自然语言中提取API参数
- **真实路径获取**：调用高德地图步行路径API
- **Dify工作流集成**：基于位置的智能问答

## 📊 支持的功能

### 偏好类型
- 🌊 **水景**：湖泊、河流、海滨、滨水公园
- 🌳 **公园**：城市公园、绿地、植物园
- 🏛️ **历史**：古迹、文化景点、博物馆
- 🛍️ **商业**：购物街、商圈、商业中心
- 🌲 **自然**：山林、郊野、森林公园
- 🏢 **科技**：科技园、现代建筑、商务区

### 终点类型
- 🚇 地铁站
- 🚌 公交站
- 🎯 知名景点
- 🛒 购物中心
- 🔄 返回起点（环形路线）

### 导出格式
- 📄 **详细JSON**：包含完整路线、导航、AI分析数据
- 📋 **简化JSON**：基础路线信息
- 📝 **导航文本**：可打印的分步指令
- 🗺️ **GPX格式**：可导入GPS设备

## 🔧 技术栈

- **前端框架**：原生HTML5 + CSS3 + JavaScript ES6+
- **地图服务**：高德地图Web API
- **AI服务**：OpenRouter (Claude-4) + Dify工作流
- **部署平台**：Replit
- **API管理**：环境变量 + 本地存储

## 📱 响应式设计

项目完全支持响应式设计：

- **桌面端**：完整功能展示，双面板布局
- **平板端**：适配中等屏幕，优化交互
- **移动端**：触摸友好界面，单面板布局

## 🎮 交互功能

### 键盘快捷键
- `S` 键：显示路线
- `R` 键：重置地图

### 移动端手势
- 向上滑动：显示路线
- 向下滑动：重置地图

### 地图控制
- **显示路线**：展示完整规划路径
- **重置地图**：清除路线，回到初始状态
- **详细步骤**：查看分步导航指令
- **AI过程**：查看LLM决策历史
- **导出路线**：多格式数据导出

## 🔒 隐私与安全

- **API密钥管理**：支持环境变量和git忽略
- **位置隐私**：仅在用户授权后获取位置
- **数据安全**：所有数据处理在客户端完成
- **无服务器依赖**：静态部署，无后端数据存储

## 📈 性能优化

- **异步API调用**：避免阻塞用户界面
- **智能缓存**：减少重复API请求
- **渐进式加载**：优化首屏加载时间
- **错误恢复**：API失败时的备选方案

## 🧪 测试与调试

### 开发者工具
- **终端日志导出**：完整的API调用和AI决策记录
- **鲁棒性统计**：函数名修正次数和成功率
- **AI过程查看**：LLM对话历史和决策分析

### 测试建议
- 使用真实地址进行测试
- 测试不同偏好类型的路线质量
- 验证移动端响应式布局
- 检查API密钥配置正确性

## 🤝 贡献指南

1. Fork 项目到你的账户
2. 创建功能分支：`git checkout -b feature/AmazingFeature`
3. 提交更改：`git commit -m 'Add some AmazingFeature'`
4. 推送分支：`git push origin feature/AmazingFeature`
5. 创建Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 🔮 未来规划

- [ ] 支持更多地图服务商（百度地图、腾讯地图）
- [ ] 增加天气信息集成
- [ ] 添加社交分享功能
- [ ] 支持离线地图下载
- [ ] 集成实时交通信息
- [ ] 添加用户评价和点评系统

## 📞 联系与支持

- 🐛 **Bug报告**：在GitHub Issues中提交
- 💡 **功能建议**：在Discussions中讨论
- 📧 **技术支持**：通过Replit评论联系

---

**🌟 用AI重新定义散步体验！让每一次出行都成为智能化的探索之旅！**
